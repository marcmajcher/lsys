"use strict";function render(){var t=document.getElementById("lsys"),e=new Turtle("turtle-canvas"),n=t.axiom.value,i=t.prods.value.split(";"),r={};i.forEach(function(t){var e=t.split(":"),n=_slicedToArray(e,2),i=n[0],s=n[1];r[i]=s});var s=t.dist.value,a=t.angle.value,o=t.steps.value;new Lsystem(e,n,r,s,a).step(o).render(400,750,270)}function setup(){document.getElementById("btn-render").addEventListener("click",function(t){t.preventDefault(),render()})}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function t(t,e){var n=[],i=!0,r=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(i=(a=o.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw s}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),defaultDistance=10,defaultAngle=90,Lsystem=function(){function t(e,n,i){var r=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:defaultDistance,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:defaultAngle;_classCallCheck(this,t),this.turtle=e,this.axiom=n,this.prods=i,this.distance=s,this.angle=a,this.reset(),this.rules={F:function(){r.turtle.penDown(),r.turtle.forward(r.distance)},f:function(){r.turtle.penUp(),r.turtle.forward(r.distance)},"+":function(){return r.turtle.right(r.angle)},"-":function(){return r.turtle.left(r.angle)},"[":function(){return r.turtle.save()},"]":function(){return r.turtle.restore()}}}return _createClass(t,[{key:"reset",value:function(){return this.moves=this.axiom,this}},{key:"step",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<t;e++){var n=this.moves;this.moves="";for(var i=0;i<n.length;i++)this.moves+=this.prods[n[i]]||n[i]}return this}},{key:"render",value:function(t,e,n){this.turtle.reset(),t&&e&&this.turtle.moveTo(t,e),n&&this.turtle.turn(n);for(var i=0;i<this.moves.length;i++){var r=this.rules[this.moves[i]];r&&r()}return this}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Turtle=function(){function t(e){_classCallCheck(this,t),this.canvas=document.getElementById(e),this.ctx=this.canvas.getContext("2d"),this.reset()}return _createClass(t,[{key:"reset",value:function(){this.x=this.canvas.width/2,this.y=this.canvas.height/2,this.ctx.moveTo(this.x,this.y),this.direction=0,this.states=[],this.penDown(),this.ctx.beginPath()}},{key:"penDown",value:function(){return this.draw=!0,this}},{key:"penUp",value:function(){return this.draw=!1,this}},{key:"moveTo",value:function(t,e){return this.x=t,this.y=e,this.ctx.moveTo(t,e),this}},{key:"_go",value:function(){return this.draw&&(this.ctx.lineTo(this.x,this.y),this.ctx.stroke()),this.ctx.moveTo(this.x,this.y),this}},{key:"forward",value:function(t){return this.x+=t*Math.cos(this.direction),this.y+=t*Math.sin(this.direction),this._go()}},{key:"backward",value:function(t){return this.x+=t*Math.cos(this.direction-Math.PI),this.y+=t*Math.sin(this.direction-Math.PI),this._go()}},{key:"turn",value:function(t){this.direction=t*(Math.PI/180)}},{key:"right",value:function(t){return this.direction+=t*(Math.PI/180),this}},{key:"left",value:function(t){return this.direction-=t*(Math.PI/180),this}},{key:"save",value:function(){return this.states.push({x:this.x,y:this.y,d:this.direction}),this}},{key:"restore",value:function(){var t=this.states.pop();return t&&(this.x=t.x,this.y=t.y,this.direction=t.d),this.moveTo(this.x,this.y),this}}]),t}();