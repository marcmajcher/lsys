"use strict";function render(){var t=document.getElementById("lsys"),e=new Turtle("turtle-canvas"),n=t.axiom.value,s=t.prods.value.split(";"),r={};s.forEach(function(t){var e=t.split(":"),n=_slicedToArray(e,2),s=n[0],i=n[1];r[s]=i});var i=parseInt(t.dist.value),a=parseInt(t.angle.value),u=parseInt(t.steps.value),o=parseInt(t.startx.value),l=parseInt(t.starty.value),h=parseInt(t.starta.value);new Lsystem(e,n,r,i,a).step(u).render(o,l,h)}function setup(){document.getElementById("btn-render").addEventListener("click",function(t){t.preventDefault(),render()})}function fillForm(t){var e=document.getElementById("lsys");e.axiom.value=sets[t].axiom,e.angle.value=sets[t].angle,e.dist.value=sets[t].dist,e.steps.value=sets[t].steps,e.startx.value=sets[t].startx,e.starty.value=sets[t].starty,e.starta.value=sets[t].starta;var n=sets[t].prods;e.prods.value=Object.keys(n).map(function(t){return t+":"+n[t]}).join(";")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function t(t,e){var n=[],s=!0,r=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(s=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);s=!0);}catch(t){r=!0,i=t}finally{try{!s&&u.return&&u.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),sets={one:{axiom:"F-F-F-F",prods:{F:"F+F-F-FF+F+F-F"},angle:90,dist:6,steps:3,startx:200,starty:600,starta:0}},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,n,s){return n&&t(e.prototype,n),s&&t(e,s),e}}(),defaultDistance=10,defaultAngle=90,Lsystem=function(){function t(e,n,s){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:defaultDistance,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:defaultAngle;_classCallCheck(this,t),this.turtle=e,this.axiom=n,this.prods=s,this.distance=i,this.angle=a,this.reset(),this.rules={F:function(){r.turtle.penDown(),r.turtle.forward(r.distance)},f:function(){r.turtle.penUp(),r.turtle.forward(r.distance)},"+":function(){return r.turtle.right(r.angle)},"-":function(){return r.turtle.left(r.angle)},"[":function(){return r.turtle.save()},"]":function(){return r.turtle.restore()}}}return _createClass(t,[{key:"reset",value:function(){return this.moves=this.axiom,this}},{key:"step",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<t;e++){var n=this.moves;this.moves="";for(var s=0;s<n.length;s++)this.moves+=this.prods[n[s]]||n[s]}return this}},{key:"render",value:function(t,e,n){this.turtle.reset(),t&&e&&this.turtle.moveTo(t,e),n&&this.turtle.turn(n);for(var s=0;s<this.moves.length;s++){var r=this.rules[this.moves[s]];r&&r()}return this}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,n,s){return n&&t(e.prototype,n),s&&t(e,s),e}}(),Turtle=function(){function t(e){_classCallCheck(this,t),this.canvas=document.getElementById(e),this.ctx=this.canvas.getContext("2d"),this.reset()}return _createClass(t,[{key:"reset",value:function(){this.x=this.canvas.width/2,this.y=this.canvas.height/2,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.moveTo(this.x,this.y),this.direction=0,this.states=[],this.penDown(),this.ctx.beginPath()}},{key:"penDown",value:function(){return this.draw=!0,this}},{key:"penUp",value:function(){return this.draw=!1,this}},{key:"moveTo",value:function(t,e){return this.x=t,this.y=e,this.ctx.moveTo(t,e),this}},{key:"_go",value:function(){return this.draw&&(this.ctx.lineTo(this.x,this.y),this.ctx.stroke()),this.ctx.moveTo(this.x,this.y),this}},{key:"forward",value:function(t){return this.x+=t*Math.cos(this.direction),this.y+=t*Math.sin(this.direction),this._go()}},{key:"backward",value:function(t){return this.x+=t*Math.cos(this.direction-Math.PI),this.y+=t*Math.sin(this.direction-Math.PI),this._go()}},{key:"turn",value:function(t){this.direction=t*(Math.PI/180)}},{key:"right",value:function(t){return this.direction+=t*(Math.PI/180),this}},{key:"left",value:function(t){return this.direction-=t*(Math.PI/180),this}},{key:"save",value:function(){return this.states.push({x:this.x,y:this.y,d:this.direction}),this}},{key:"restore",value:function(){var t=this.states.pop();return t&&(this.x=t.x,this.y=t.y,this.direction=t.d),this.moveTo(this.x,this.y),this}}]),t}();